




[![](https://img.shields.io/badge/CoAdapTree-UBC-green.svg?style=popout&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAXCAYAAAAP6L+eAAAGPklEQVR42oVVa0xb5xl2GtIWyKLcWNJAFgLkYjAJN2McTGzwBWMcwDYmELCxjS8Y29jG2CGYgB1ICAFMoLZbaGi4tKVlbdN0yySyTkzVqqptpE77MVXrqm5Sf6Stum7LUjIwfnbOYbGy9fZJn877fDrv8z3v5byH9n3L5/M9Ru5Hz25cG7EHu81hwowj8fh5+6CjVvTxkF3XsjQ3l/jQ7zsJQaNtIvdDfHM+lLG8cD2VtEe6zHOBdjVkR7ZXk1gtLnnLLOFAK+Lesym1SeTZDypVKpWbcefOFhK//YtZ/a35ib/pC2kHFSlJEp2oBNLczD+9feO6bahD/1tB2h7wc47PLw13JgbPmqp/+dyIfHl5OS5GCGCTzVbxBGnfvbuU+NK4byHs63C89fIz0lB/x2eT/S7MX/a+qmQd+qgoaQfCPhemfA7Iio5BUpj7Gx2f/d6QpQkvXR34ZDkU2vpflbzYDdcHXcxRtzH8tM/51evhi/Bo5O+JGRmLAw4TFif80IvZoO9OWi3eRlsRZ6VFuFn0dS49HSpuPqwSzu1vpUCj4T05PeLjTF10f2hTlsOlrf/HZH/HvzlH9kPKzoO0gL4iL2FG1GJulJd5CGSQ++O3oTTrMLS8vJUxhwqvhC/9udeqnhrzGL1kTim1JiU/09Ik//v5dn1EVHRslbF/H5qlZdFG8clIfnoKspP34sDWHdG9NFpUzmHCUHcKEjaRhpwjqM6nw35GCq+1JdJySvjJ1ICnjVLb2yqXhfyOj5Ri3ppMwEV4oDOSsisxSqoK++wI+azrpM1Iy8CeXT+FmH4AV7vMmBnxwtumBouRtZ6Z8BiaRex7MwFfP4A4Gj7+1RN97drpZ/rd6LU0/YtoQlz12tDXWkeFWysuhd+mgqy0kMLpKSlgpiShrpQFS6MMamkZznCZaBEVRoIXXKsvjvYg1N3morkNCl2PVYd6qfCBXS1HIYOOeNrjOCM6gYL0VOhrJWiuEVCkGfuSsT9pN2FvofA+YnPpB6E4wVhXCVnwG+twxanpnpz0JdC6nLq09pbGtdOVQrRrG9areCz02dSkI7VNtRWYGfIQOa2gcNrO3ajiFkHAzqMwUaC10uPpqOMXvt9axffEumFpaS7xxvzUXUODDM8OdEVaifAGnHpcsGtIR0qdjM/BOcNp8kmd8fMzcdmpQ+BcK9z601FJUQ7Kcw9/rRIw/znh63wDwOMkd/zrLz7/l/H+bggLsiMefRNxmoi2+irI+cXYEb8DOxO3xyJIT06hnsU52QRpA6wqZbQk+yhOsY6tXnFqMRvwfQBgM6U6OHzxg/GBHuhqJat85nHwWXnIz8zYIHoqGU51DTq1MvwkPgFxRAS5aakoYaQjaw8NPyParzz/CExEHbxG1VcTHltKLB0vhIY//PXCc5gd9a8G/W6Y6iQY7zGjumyjE8pZxzFy1oBhIvQGKZ+aUwo+G4GzmtXZKx1E2rS3LHJBuEejkDwcDxTxWHf75PQFN9qbFCt9NgM8RhXamhQgphlExfkU+eHkA2iWSwjMovCB+Cehkp78JnDOiMlBzzvvL9/aS3IZjcYtMcU3F6b3zQ/3RvosWuyM27LOyqJTzjlHj6KMzcTWhF0QFeXBUi8hohFAITwRZdIzotycozDW8BDqs+L6Vb8yRkiO3eVpa8HTVoEv1G37YuK8C0Nu81qvuRHlnLyojFeA7NSNwiUQBTUoxPDbVetk59Rw2WsqSckdl15+by7QjVenAq2PTkraH98cGLs9bsBsV/V9XY0IUg4rcqnT/GDQY4ZbI8egU422hnJkH0olCrc5WlvOQX1l8Te6ah7Om1RjAZ+p4I2ZUcvt114o/h/F938/9+bnvwtjtpONUUfj140VG1+ZgM26z6BnPpCVnYh6WxuiNeVcanYohJxov0ON4AU7nr3cg59fC/JJpm/9lvDpje2fvXut55VhzQKLRts27m1vbpCUfmkhcqcSbHxdVSUsWM9UrpvqK1cqeRzUivh/9Ts1706N9PzhtZngSZJncVG5mfZjazZ4adewXWUYczTe1FfzoweT9kSU/CK4tAqYlBUQF+aOfofbpkcBcdNi7Cby1v9/wdlYnV2Wz0ivFZbwLUrhO72tdZ9fdrWcjJF9z/oPOHr50Rw5rjUAAAAASUVORK5CYII=)](http://coadaptree.forestry.ubc.ca)
[![](https://img.shields.io/badge/python-3.7-blue.svg?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAH1UlEQVRYw62Yb4xcVRnGf++5Z2Znd9m20NYETJQ/goSKYqyFhkR2pUgiEoU4a5SEBBP1k9EvxoAaBj9AAhFBg/ELITHhy46CRBMT/9AFTKGQmhKoiNAIYvjXQrvsv5m597yPH+7M7Ox2tt2Im5zcmbt3zvuc5zzvc973Ghv4q8/MZM3p6VSvz2SvXVD9PB72yPwS3M8U2mLiDOQOegfpmMGrEs+EUPz+yTtveBqgXp/Jms3pdKpYdkow3YkuveWRqwL2yzi26VwLGUVrHnkqRyoAYRbKEcqr5y286DxaFOmmA/fe+O+NgLKNgNl18+92x0rcFyojFItzL8mYMws7lfIEMqSABMgRAgm5kEIcPS0rluePelZc/MxdN71JoxFoNHy9mOFkgI7s2G7lQ/6tODpBWpp7wtr5J/bfcd2nSfn9WXU0Q3gXDEgBPEMekSqgrFiaX67UTtsWiuw2gEmuOGnMsBENYWQhi8js8Sd/Or0M4PjDZgHkPTAr11WfvZryFrh/HGCWx/xkoeKGAMlD0VpA7l/fffNDf7LC/pNUNDxvgWTd6HYCGMpR6kJpI6FOwdBj5VQouCfMOBMLs575yyFWdnrREUa2LpiBe5IbQKP8j0nD9RvXirinmxLMhyNQIJlJKKVcpAgypdyB0A86DAw9MOrHaDQa3hhIJ+2djEzOJjO0CtBkY29sNqYKmqsAFwALtXRjtf3et2s5aZDcVFu2qqLbYiV2Ku39IYvnpKLjJoVVDElIpXQOzdSrF20/4kzMm+08kNvUbAGgmXpm080Uu7DDbGOq2P39316sjBuQnSO5wJFktqwOqFBF5t7TpAidCjkSlXZAbFUqMGGDYCQRTbySW0diQi8u7UejY1BL+vvVOe5/ZlQ/sPOac1I9i/X6TNZsTKfdtzxys2WV27NKtTQ7yo1Wf7NL+jMN04hTtBaRu8D7etKAqJccARnShYwGo+gubLz6Ud5pX6vnrtxl1nwrNpvT6bIfPvKNOLrl9nzhXU9Fu0AeTgzKQIqXiV/G6z+XnQCmv2VOwOE4IC2xnMaREsJYLtqcXvkQ77YfBPbESxoPb6Gtu4qlOSQJVF3XUziFgNeCYWA4xhbgDQIGuELXMkY51s4Zy67UwSunQq0d6rF22mZPRQ7K/q9g1KVQUOBLQEIDFtFjuNxMIH0lAHukRN9L/p9gypHHGJlfDn8Fxi2GGsm16hlXoOMg7QoiXegp7zruycCgriflA9ccqZDIBTmie48cVICKUB0bHWkff48Hv3kH//jMFxk3cCUcG9jWQCsBXBCRtnfLh3XcFpASRharo7GWGdG6WSc/UcArZxied8jS/N/+cO8HrgFQUfuRLXbACPgqJq3rnuMRUQJaKSHWgPFksZpVilay9sJDf3lz5HFei8eRG95Lv8SKZTrgxiKLPH/Gs3DdYYktev7qfTbGB1lKBVJca5xdQhS7y+xuyQk6SharWS0tH5q9e9seuOZNifM5dtEu8uomfPDgTiUWvPd1gs7ER2hdvUuHuNbGqLJYJFBcBWRw8YiI/KiFeJboaJWOkGOWVVNrcfYnZ10uXdVJh+v7eMt2MxKgumbStWLOBNGhWmDzOSwq9bNYa2yhBCOERdA7FuwsFdIaUaeR0bFwbH7hPrhqLh2u/yvbZmdztFWwgHo6GdDZsAzrGrWyE8D0zRaQRMBwzUWJl82yi7vH8uCkYYTEcz+b+I3e3lWnFs/myGILqA2ZcEgQ+tswlElW/c6phoxlHQq4P2EG3Rq4t2JJCio6wNgR2hOXkyfwgf3nlEHWB7OWUeRUANfeEBIPF8sLqdQTGpyozMTMwEZXVr8OGG0EDMO215Eiczlk4YHw1D1ffUXyX1TGNxumVnnouZuRyhqmxSrPWB9MaZbltcDXfIe8e6+A/v0cIbZVDLdbbee+wxHg6U0vf/fSuXM/VhnfPJXaS2U3I5FVIpDCkJN99YoRbI6xPDR9mLDLBEgDv3eBCZYTHOncaZc99WMJi70+aT98dtd3HviemX0ZaRzkSctjcMYSCqHnyitMdbMDGa6cY/mvMM3jHgGVrPZ8SSKRYV7D+4wG5K9j4dd26VMH1S1qrVcxDmveJIIZrn9+4UE2ZV/jeKcoja2vgzJdky/SSZdD8TpZNkKqOCxBLYiWG1kl4CzYJ2ePD21q9k5GpmaTgXolrAM22dibzfKY98HNTgaYddxBgVXC7p1BhQCNM5odhO4zoYBQpc/SuMHx/ACwU4d2VHl7ezn/JNDcLptqFsO6Ds02porhzZK0WjdrnVaQu3BZmcIh0EllO51ZeZK75wBcdCi3Hej9da4+aHbDsq1faCWiBdrpJZwduF9Axw8yYiuN4m0nf5+wMUBStip7hoMp2RnPwLnPPvX4C7Zz32HQ3YwG+s3Zreuzc2pAk31A+6kGQHnXMVfAsApgYDmB+XU6tKNaNiy6nk4ClT0ezfr7edkwW9L8/Kafc7T9NFuro72yFFH0TLQ0HznIWCoKol3B0pYXeGb3i0zEL5XVoO4p2+P30dubIakRbLqZGOtcwZHW/YDYFCtMZJGxkFENgRgC0QIVC9RCJAO2xnM5vXI+c/mrzPv1dtn+RzRTz8ya//sLqxUJNYJZaQV69nPnYMU1KO1Gdh7uW8sKwEOXuXnQG+DP4eFRsvYfbeeBvNcqnyrWfwFDDqXfRXA8NgAAAABJRU5ErkJggg==&style=popout)](https://www.python.org)
[![](https://img.shields.io/badge/GATK-4.1.0.0-red.svg?style=popout&logo=data:image/png;base64,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)](https://software.broadinstitute.org/gatk/)
[![](https://img.shields.io/badge/Developed%20With-PyCharm-yellow.svg?style=popout&logo=data:image/png;base64,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)](https://www.jetbrains.com/pycharm/)

# GATK individual and poolseq pipeline

---
## Assumed environment
1. Access to an HPC with a scheduler (e.g., slurm, SGE, PBS, TORQUE) - this pipeline assumes slurm
1. Ability to install an anaconda (not miniconda) or virtual environment with python 3.7 (eg: `conda create -n py3 python=3.7` or `virtualenv --no-download ~/py3`)
    1. source env within `$HOME/.bashrc` on the last line of the file (eg `source ~/anaconda3/bin/activate py3` for conda, or `source ~/py3/bin/activate` for virutalenv)
1. Ability to load the following modules via:
    1. `module load bwa/0.7.17`
    1. `module load samtools/1.9`
    1. `module load picard/2.18.9`
    1. `module load gatk/4.1.0.0`
    1. `module load bcftools/1.9`
1. copy the following into your `$HOME/.bashrc` file so that the `def-someuser` reflects your non-RAC compute canada account
    ```
    export SLURM_ACCOUNT=def-someuser
    export SBATCH_ACCOUNT=$SLURM_ACCOUNT
    export SALLOC_ACCOUNT=$SLURM_ACCOUNT
    ```
1. clone the pipeline repo's master branch to the server and create a symlink in `$HOME` so that it can be accessed via `$HOME/gatk_pipeline`


## Using the pipeline
- First create a python3 environment (see above).
    - then use the `requirements.txt` file in the repo to install the appropriate python dependencies.
        - `pip install -r $HOME/gatk_pipeline/requirements.txt`
- See example datatable.txt file needed for `00_start-pipeline.py`.
    - file names in `file_name_r1` and `file_name_r2` should be basenames not full paths
    - the entries in the `ref` column should be full paths
    - sample names in 'sample_name' column can be duplicates for samps sequenced multiple times
	- RG info, file paths, etc should of course be different between sequenced files of single samps
- Once the environment is set up, put `datatable.txt` and the fastq files (symlinks work too) into a folder. This is the folder I call `PARENTDIR`.

- To kick off the pipeline, source your bashrc (`source ~/.bashrc`) to activate the python env, export the path to the pipeline `export PYTHONPATH="${PYTHONPATH}:$HOME/gatk_pipeline`, and run `00_start-gatk_pipeline.py` from the home node, and it will run the rest of the preprocessing pipeline automatically by serially sbatching jobs (through `04_scatter-gvcf.py`).

`(py3) [user@host ~]$ python $HOME/gatk_pipeline/00_start-gatk_pipeline.py -p PARENTDIR [-e EMAIL [-n EMAIL_OPTIONS]] [-h]`
```
optional arguments:
  -e EMAIL              the email address you would like to have notifications
                        sent to (default: None)
  -n EMAIL_OPTIONS [EMAIL_OPTIONS ...]
                        the type(s) of email notifications you would like to
                        receive from the pipeline. Requires --email-address.
                        These options are used to fill out the #SBATCH flags.
                        must be one (or multiple) of ['all', 'none', 'fail',
                        'begin', 'end', 'pipeline-finish']
  -h, --help            Show this help message and exit.

required arguments:
  -p PARENTDIR          /path/to/directory/with/fastq.gz-files/
```


